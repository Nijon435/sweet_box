<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Staff Management</title>
    <link rel="icon" href="img/sweetbox_icon.ico" />
    <link rel="preconnect" href="https://fonts.googleapis.com" />
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin />
    <link
      href="https://fonts.googleapis.com/css2?family=Poppins:wght@400;500;600;700&display=swap"
      rel="stylesheet"
    />
    <link rel="stylesheet" href="design.css" />
    <link rel="stylesheet" href="responsive.css" />
    <link rel="stylesheet" href="css/modal.css" />
    <link rel="stylesheet" href="css/employees.css" />
  </head>

  <body data-page="employees">
    <div class="layout">
      <aside class="sidebar">
        <div class="brand">
          <img src="img/sweetbox_logo.png" alt="Sweet Box" class="brand-logo" />
        </div>
        <nav class="nav">
          <a href="index.html" data-section="dashboard">Dashboard</a>
          <a href="attendance.html" data-section="attendance">Attendance</a>
          <a
            href="employees.html"
            data-section="employees"
            data-role="admin,manager"
            data-hide-when-denied="true"
            >Users</a
          >
          <a
            href="inventory.html"
            data-section="inventory"
            data-role="admin,manager,kitchen_staff"
            data-hide-when-denied="true"
            >Inventory</a
          >
          <a href="orders.html" data-section="orders">Orders</a>
          <a
            href="analytics.html"
            data-section="analytics"
            data-role="admin,manager"
            data-hide-when-denied="true"
            >Analytics</a
          >
          <a
            href="report.html"
            data-section="report"
            data-role="admin,manager"
            data-hide-when-denied="true"
            >Reports</a
          >
          <a
            href="archive.html"
            data-section="archive"
            data-role="admin"
            data-hide-when-denied="true"
            >Archive</a
          >
        </nav>
        <div class="user-session">
          <div class="user-session-info">
            <div class="user-session-row">
              <strong id="session-name" class="user-session-name">Guest</strong>
              <button
                id="edit-profile-btn"
                type="button"
                class="user-session-edit-btn"
                title="Edit Profile"
              >
                ✏️
              </button>
            </div>
            <small id="session-role" class="user-session-role"
              >Sign in required</small
            >
          </div>
          <button class="btn btn-outline" id="logout-btn" type="button">
            Sign out
          </button>
        </div>
      </aside>

      <main class="main-content">
        <header class="page-header">
          <div>
            <span class="pill">HR tools</span>
            <h1>Staff Management</h1>
          </div>
          <div class="actions">
            <button class="btn btn-secondary" id="refresh-data">Refresh</button>
          </div>
        </header>

        <!-- Live Metrics -->
        <section class="card live-metrics-card">
          <div class="live-metrics-grid">
            <div class="live-metric-item">
              <small>Total Staff</small>
              <div class="live-metric-value" id="quick-total-staff">0</div>
            </div>
            <div class="live-metric-item">
              <small>Active</small>
              <div class="live-metric-value active" id="active-today-count">
                0
              </div>
            </div>
            <div class="live-metric-item">
              <small>Inactive</small>
              <div class="live-metric-value inactive" id="inactive-count">
                0
              </div>
            </div>
            <div class="live-metric-item">
              <small>On Shift</small>
              <div class="live-metric-value on-shift" id="on-shift-count">
                0
              </div>
            </div>
            <div class="live-metric-item">
              <small>Off Shift</small>
              <div class="live-metric-value off-shift" id="off-shift-count">
                0
              </div>
            </div>
            <div class="live-metric-item">
              <small>Absent</small>
              <div class="live-metric-value absent" id="absent-count">0</div>
            </div>
            <div class="live-metric-item">
              <small>On Leave</small>
              <div class="live-metric-value on-leave" id="on-leave-count">
                0
              </div>
            </div>
          </div>
        </section>

        <!-- Container for Users Overview and Requests side by side -->
        <div
          style="
            display: grid;
            grid-template-columns: 2fr 1fr;
            gap: 1.5rem;
            margin-top: 1.5rem;
          "
        >
          <!-- Users Overview -->
          <section class="card">
            <div class="section-heading">
              <h2>Users Overview</h2>
              <span class="pill">Live</span>
            </div>

            <!-- Access Distribution -->
            <div style="margin-bottom: 1.5rem">
              <strong
                style="display: block; margin-bottom: 0.75rem; color: #555"
                >Access Distribution</strong
              >
              <div
                style="
                  display: flex;
                  gap: 0.5rem;
                  margin-bottom: 0.5rem;
                  height: 32px;
                  border-radius: 6px;
                  overflow: hidden;
                "
              >
                <div
                  id="access-bar-admin"
                  style="
                    background: #f6c343;
                    display: flex;
                    align-items: center;
                    justify-content: center;
                    font-size: 0.875rem;
                    font-weight: 600;
                    color: #333;
                    transition: all 0.3s;
                  "
                  title="Admin"
                ></div>
                <div
                  id="access-bar-manager"
                  style="
                    background: #9c27b0;
                    display: flex;
                    align-items: center;
                    justify-content: center;
                    font-size: 0.875rem;
                    font-weight: 600;
                    color: white;
                    transition: all 0.3s;
                  "
                  title="Manager"
                ></div>
                <div
                  id="access-bar-kitchen"
                  style="
                    background: #ff9800;
                    display: flex;
                    align-items: center;
                    justify-content: center;
                    font-size: 0.875rem;
                    font-weight: 600;
                    color: white;
                    transition: all 0.3s;
                  "
                  title="Kitchen Staff"
                ></div>
                <div
                  id="access-bar-staff"
                  style="
                    background: #2196f3;
                    display: flex;
                    align-items: center;
                    justify-content: center;
                    font-size: 0.875rem;
                    font-weight: 600;
                    color: white;
                    transition: all 0.3s;
                  "
                  title="Staff"
                ></div>
              </div>
              <div
                style="
                  display: flex;
                  gap: 1.5rem;
                  flex-wrap: wrap;
                  margin-top: 0.75rem;
                  font-size: 0.875rem;
                "
              >
                <div style="display: flex; align-items: center; gap: 0.5rem">
                  <span
                    style="
                      width: 12px;
                      height: 12px;
                      background: #f6c343;
                      border-radius: 2px;
                      display: inline-block;
                    "
                  ></span>
                  <span id="access-legend-admin">0 Admin</span>
                </div>
                <div style="display: flex; align-items: center; gap: 0.5rem">
                  <span
                    style="
                      width: 12px;
                      height: 12px;
                      background: #9c27b0;
                      border-radius: 2px;
                      display: inline-block;
                    "
                  ></span>
                  <span id="access-legend-manager">0 Manager</span>
                </div>
                <div style="display: flex; align-items: center; gap: 0.5rem">
                  <span
                    style="
                      width: 12px;
                      height: 12px;
                      background: #ff9800;
                      border-radius: 2px;
                      display: inline-block;
                    "
                  ></span>
                  <span id="access-legend-kitchen">0 Kitchen</span>
                </div>
                <div style="display: flex; align-items: center; gap: 0.5rem">
                  <span
                    style="
                      width: 12px;
                      height: 12px;
                      background: #2196f3;
                      border-radius: 2px;
                      display: inline-block;
                    "
                  ></span>
                  <span id="access-legend-staff">0 Staff</span>
                </div>
              </div>
            </div>

            <!-- Stats: Active Rate, Newest Hire, Average Tenure -->
            <div
              style="
                display: grid;
                grid-template-columns: repeat(3, 1fr);
                gap: 1rem;
                padding-top: 1rem;
                border-top: 1px solid #eee;
              "
            >
              <div>
                <small
                  style="
                    color: #666;
                    font-size: 0.875rem;
                    display: block;
                    margin-bottom: 0.25rem;
                  "
                  >Active Rate</small
                >
                <strong
                  style="font-size: 1.25rem; color: #4caf50"
                  id="active-rate"
                  >0%</strong
                >
              </div>
              <div>
                <small
                  style="
                    color: #666;
                    font-size: 0.875rem;
                    display: block;
                    margin-bottom: 0.25rem;
                  "
                  >Newest Hire</small
                >
                <strong style="font-size: 1rem; color: #333" id="newest-hire"
                  >--</strong
                >
              </div>
              <div>
                <small
                  style="
                    color: #666;
                    font-size: 0.875rem;
                    display: block;
                    margin-bottom: 0.25rem;
                  "
                  >Average Tenure</small
                >
                <strong style="font-size: 1rem; color: #333" id="average-tenure"
                  >--</strong
                >
              </div>
            </div>
          </section>

          <!-- Requests - Separate Card -->
          <section class="card">
            <div class="section-heading">
              <h2>Requests</h2>
              <span class="pill">Pending</span>
            </div>
            <div
              id="leave-approval-list"
              style="overflow-y: auto; min-height: 250px; max-height: 400px"
            >
              <p
                style="
                  color: #888;
                  font-size: 0.875rem;
                  text-align: center;
                  padding: 1rem;
                "
              >
                No pending requests
              </p>
            </div>
          </section>
        </div>

        <section class="table-wrapper" style="margin-top: 2rem">
          <div
            style="
              display: flex;
              justify-content: space-between;
              align-items: center;
              margin-bottom: 1rem;
              gap: 1rem;
            "
          >
            <div>
              <h2 style="margin: 0 0 0.25rem 0">Employee Roster</h2>
              <span class="pill">System of record</span>
            </div>
            <div
              style="
                display: flex;
                gap: 0.75rem;
                align-items: center;
                flex-wrap: nowrap;
              "
            >
              <input
                type="text"
                id="staff-search"
                placeholder="Search by name, email, or role..."
                style="
                  padding: 0.5rem 1rem;
                  border: 1px solid #ddd;
                  border-radius: 4px;
                  min-width: 250px;
                "
              />
              <select
                id="access-filter"
                style="
                  padding: 0.5rem;
                  border: 1px solid #ddd;
                  border-radius: 4px;
                "
              >
                <option value="">All Access</option>
                <option value="admin">Admin</option>
                <option value="manager">Manager</option>
                <option value="kitchen_staff">Kitchen Staff</option>
                <option value="staff">Staff</option>
              </select>
              <select
                id="status-filter"
                style="
                  padding: 0.5rem;
                  border: 1px solid #ddd;
                  border-radius: 4px;
                "
              >
                <option value="">All Status</option>
                <option value="active">Active</option>
                <option value="inactive">Inactive</option>
              </select>
              <button
                class="btn btn-primary"
                id="add-employee-btn"
                style="white-space: nowrap"
              >
                + Add Employee
              </button>
            </div>
          </div>
          <table id="employee-table">
            <thead>
              <tr>
                <th>Name</th>
                <th>Email</th>
                <th>Phone</th>
                <th>Role</th>
                <th>Access</th>
                <th>Shift Start</th>
                <th>Hire Date</th>
                <th>Status</th>
                <th>Actions</th>
              </tr>
            </thead>
            <tbody></tbody>
          </table>
        </section>
      </main>
    </div>

    <!-- Add Access Modal -->
    <div id="add-access-modal" class="modal-overlay">
      <div class="modal-card" style="max-width: 700px">
        <div class="modal-card__header">
          <h2>Create New Access Level</h2>
          <button
            class="btn btn-outline"
            type="button"
            id="add-access-close"
          >
            Close
          </button>
        </div>
        <form id="add-access-form">
          <label for="access-name">Access Level Name *</label>
          <input
            id="access-name"
            type="text"
            name="accessName"
            placeholder="e.g., Manager, Supervisor, etc."
            required
          />

          <label>Page Access *</label>
          <p style="font-size: 0.875rem; color: #666; margin-bottom: 1rem">
            Select which pages this access level can view:
          </p>
          <div
            style="
              display: grid;
              grid-template-columns: repeat(2, 1fr);
              gap: 0.75rem;
              background: #f9f9f9;
              padding: 1rem;
              border-radius: 6px;
              margin-bottom: 1rem;
            "
          >
            <label style="display: flex; align-items: center; gap: 0.5rem; cursor: pointer;">
              <input
                type="checkbox"
                name="pages"
                value="index.html"
                  style="width: 18px; height: 18px; cursor: pointer"
                />
                <span style="font-size: 0.95rem">Dashboard</span>
              </label>
              <label
                style="
                  display: flex;
                  align-items: center;
                  gap: 0.5rem;
                  cursor: pointer;
                  padding: 0.5rem;
                  border-radius: 4px;
                  transition: background 0.2s;
                "
                onmouseover="this.style.background='#fff'"
                onmouseout="this.style.background='transparent'"
              >
                <input
                  type="checkbox"
                  name="pages"
                  value="employees.html"
                  style="width: 18px; height: 18px; cursor: pointer"
                />
                <span style="font-size: 0.95rem">Employees</span>
              </label>
              <label
                style="
                  display: flex;
                  align-items: center;
                  gap: 0.5rem;
                  cursor: pointer;
                  padding: 0.5rem;
                  border-radius: 4px;
                  transition: background 0.2s;
                "
                onmouseover="this.style.background='#fff'"
                onmouseout="this.style.background='transparent'"
              >
                <input
                  type="checkbox"
                  name="pages"
                  value="inventory.html"
                  style="width: 18px; height: 18px; cursor: pointer"
                />
                <span style="font-size: 0.95rem">Inventory</span>
              </label>
              <label
                style="
                  display: flex;
                  align-items: center;
                  gap: 0.5rem;
                  cursor: pointer;
                  padding: 0.5rem;
                  border-radius: 4px;
                  transition: background 0.2s;
                "
                onmouseover="this.style.background='#fff'"
                onmouseout="this.style.background='transparent'"
              >
                <input
                  type="checkbox"
                  name="pages"
                  value="orders.html"
                  style="width: 18px; height: 18px; cursor: pointer"
                />
                <span style="font-size: 0.95rem">Orders</span>
              </label>
              <label
                style="
                  display: flex;
                  align-items: center;
                  gap: 0.5rem;
                  cursor: pointer;
                  padding: 0.5rem;
                  border-radius: 4px;
                  transition: background 0.2s;
                "
                onmouseover="this.style.background='#fff'"
                onmouseout="this.style.background='transparent'"
              >
                <input
                  type="checkbox"
                  name="pages"
                  value="attendance.html"
                  style="width: 18px; height: 18px; cursor: pointer"
                />
                <span style="font-size: 0.95rem">Attendance</span>
              </label>
              <label
                style="
                  display: flex;
                  align-items: center;
                  gap: 0.5rem;
                  cursor: pointer;
                  padding: 0.5rem;
                  border-radius: 4px;
                  transition: background 0.2s;
                "
                onmouseover="this.style.background='#fff'"
                onmouseout="this.style.background='transparent'"
              >
                <input
                  type="checkbox"
                  name="pages"
                  value="analytics.html"
                  style="width: 18px; height: 18px; cursor: pointer"
                />
                <span style="font-size: 0.95rem">Analytics</span>
              </label>
              <label
                style="
                  display: flex;
                  align-items: center;
                  gap: 0.5rem;
                  cursor: pointer;
                  padding: 0.5rem;
                  border-radius: 4px;
                  transition: background 0.2s;
                "
                onmouseover="this.style.background='#fff'"
                onmouseout="this.style.background='transparent'"
              >
                <input
                  type="checkbox"
                  name="pages"
                  value="report.html"
                  style="width: 18px; height: 18px; cursor: pointer"
                />
                <span style="font-size: 0.95rem">Reports</span>
              </label>
            </div>
          </div>

          <label for="access-description">Description (Optional)</label>
          <textarea
            id="access-description"
            name="description"
            placeholder="Brief description of this access level's responsibilities..."
            rows="3"
          ></textarea>

          <div class="modal-card__actions">
            <button
              type="button"
              class="btn btn-secondary"
              id="add-access-cancel"
            >
              Cancel
            </button>
            <button type="submit" class="btn btn-primary">
              Create Access Level
            </button>
          </div>
        </form>
      </div>
    </div>

    <script src="https://cdn.jsdelivr.net/npm/chart.js@4.4.2/dist/chart.umd.min.js"></script>
    <script src="js/config.js"></script>
    <script src="js/common.js"></script>
    <script src="js/employees.js"></script>
  </body>
</html>
